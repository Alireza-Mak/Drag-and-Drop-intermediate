(()=>{"use strict";function e(e,t,n){const r=n.value;return{configurable:!0,enumerable:!1,get(){return r.bind(this)}}}var t;!function(e){e[e.ACTIVE=0]="ACTIVE",e[e.FINISHIED=1]="FINISHIED"}(t||(t={}));class n{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class r{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class s extends r{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new s),this.instance}addProject(e,r,s){const i=Math.random().toString(),l=new n(i,e,r,s,t.ACTIVE);this.projects.push(l),this.updatedListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updatedListeners())}deleteProject(e){this.projects=this.projects.filter((t=>t.id!==e)),this.updatedListeners()}updatedListeners(){for(const e of this.listeners)e(this.projects.slice())}}const i=s.getInstance();function l(e){return e.required&&0===e.value.toString().length?"Value is required.":null!=e.minLength&&"string"==typeof e.value&&e.value.length<e.minLength?`Character should have a minimum length of ${e.minLength}.`:null!=e.maxLength&&"string"==typeof e.value&&e.value.length>e.maxLength?`Character should have a maximum length of ${e.maxLength}.`:null!=e.min&&"number"==typeof+e.value&&+e.value<e.min?`Participants should be greater than or equal to ${e.min}.`:null!=e.max&&"number"==typeof+e.value&&+e.value>e.max?`Participants should be less than or equal to ${e.max}.`:""}class o{constructor(e,t,n,r){this.templateId=e,this.hostElementId=t,this.insertAtStart=n,this.newElementId=r,this.templateElement=document.getElementById(this.templateId),this.hostElement=document.getElementById(this.hostElementId);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,this.newElementId&&(this.element.id=this.newElementId),this.attach()}attach(){this.hostElement.insertAdjacentElement(this.insertAtStart?"afterbegin":"beforeend",this.element)}}class a extends o{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.titleErrorElement=this.element.querySelector("#title_error"),this.descriptionErrorElement=this.element.querySelector("#description_error"),this.peopleErrorElement=this.element.querySelector("#people_error"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value.trim(),t=this.descriptionInputElement.value.trim(),n=this.peopleInputElement.value.trim(),r={value:e,required:!0,minLength:4,maxLength:10},s={value:t,required:!0,minLength:4,maxLength:10},i={value:n,required:!0,min:0,max:5};if(!(l(r)||l(s)||l(i)))return[e,t,+n];this.showInputsError(l(r),l(s),l(i))}showInputsError(e,t,n){this.cleanErrors(),e&&(this.titleErrorElement.textContent=e),t&&(this.descriptionErrorElement.textContent=t),n&&(this.peopleErrorElement.textContent=n)}cleanErrors(){this.titleErrorElement.textContent="",this.descriptionErrorElement.textContent="",this.peopleErrorElement.textContent=""}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;i.addProject(e,n,r),this.clearInputs(),this.cleanErrors()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([e],a.prototype,"submitHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends o{constructor(e,t){super("single-project",e,!1,t.id),this.TouchMoveHandler=e=>{if(e.preventDefault(),d.selectedItem){const t=e.touches[0],n=t.clientX,r=t.clientY;d.selectedItem.style.left=n+"px",d.selectedItem.style.top=r+"px";const s=document.getElementById("active-projects-list"),i=document.getElementById("finished-projects-list");s.classList.remove("droppable"),i.classList.remove("droppable");const l=document.elementFromPoint(n,r),o=s.contains(l),a=i.contains(l);o?s.classList.add("droppable"):a&&i.classList.add("droppable")}},this.project=t,this.configure(),this.renderContent()}get person(){return 1===this.project.people?`Participants: ${this.project.people.toString()} person assigned.`:`Participants: ${this.project.people.toString()} people assigned.`}dragStartHandler(e){if(e instanceof DragEvent&&(e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"),e instanceof TouchEvent){const t=e.target;if("BUTTON"===t.tagName);else if("LI"!==t.tagName){const e=t.parentElement.parentElement.id.split("-")[0];d.status=e,d.selectedItem=t.parentElement}else{const e=t.parentElement.id.split("-")[0];d.status=e,d.selectedItem=t}d.selectedItem&&(d.selectedItem.style.height=d.selectedItem.clientHeight.toString(),d.selectedItem.style.width=d.selectedItem.clientWidth.toString(),d.selectedItem.style.position="fixed",d.selectedItem.style.zIndex="-10")}}dragEndHandler(e){}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("touchstart",this.dragStartHandler),this.element.addEventListener("touchmove",this.TouchMoveHandler),this.element.addEventListener("dragend",this.dragEndHandler),this.element.querySelector("button").addEventListener("click",this.deleteItem)}renderContent(){this.element.querySelector("h2").textContent=`Title: ${this.project.title}`,this.element.querySelector("h3").textContent=this.person,this.element.querySelector("button").textContent="Delete",this.element.querySelector("button").id=this.project.id,this.element.querySelector("p").textContent=`Description:  ${this.project.description}`}deleteItem(){i.deleteProject(this.project.id)}}c([e],d.prototype,"dragStartHandler",null),c([e],d.prototype,"deleteItem",null);var h=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class p extends o{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){if(e instanceof DragEvent){const n=e.dataTransfer.getData("text/plain");i.moveProject(n,"active"===this.type?t.ACTIVE:t.FINISHIED)}if(e instanceof TouchEvent&&d.selectedItem){document.querySelectorAll("ul").forEach((function(e){e.classList.remove("droppable")}));var n=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);if(n&&"UL"===n.tagName){n.appendChild(d.selectedItem);const e=d.selectedItem.id,r="active"===d.status?t.FINISHIED:t.ACTIVE;i.moveProject(e,r)}if(n&&"LI"===n.tagName){n.parentElement.insertBefore(d.selectedItem,n.nextSibling);const e=d.selectedItem.id,r="active"===d.status?t.FINISHIED:t.ACTIVE;i.moveProject(e,r)}d.selectedItem.style.left="",d.selectedItem.style.top="",d.selectedItem.style.height="",d.selectedItem.style.width="",d.selectedItem.style.position="",d.selectedItem.style.zIndex=""}}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("touchend",this.dropHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),i.addListener((e=>{const n=e.filter((e=>"active"===this.type?e.status===t.ACTIVE:e.status===t.FINISHIED));this.assignProjects=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=`${this.type} projects`.toUpperCase()}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignProjects)new d(this.element.querySelector("ul").id,e)}}h([e],p.prototype,"dragOverHandler",null),h([e],p.prototype,"dropHandler",null),h([e],p.prototype,"dragLeaveHandler",null),new a,new p("active"),new p("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qcy9idW5kbGUuanMiLCJtYXBwaW5ncyI6Im1CQUFPLFNBQVNBLEVBQVNDLEVBQVFDLEVBQXFCQyxHQUNwRCxNQUFNQyxFQUFpQkQsRUFBV0UsTUFTbEMsTUFSMEMsQ0FDeENDLGNBQWMsRUFDZEMsWUFBWSxFQUNaQyxNQUVFLE9BRGdCSixFQUFlSyxLQUFLQyxLQUV0QyxFQUdKLENDWEEsSUFBWUMsR0FBWixTQUFZQSxHQUNWLHVCQUNBLDRCQUNELENBSEQsQ0FBWUEsSUFBQUEsRUFBYSxLQUlsQixNQUFNQyxFQUNYQyxZQUNTQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUpBLEtBQUFKLEdBQUFBLEVBQ0EsS0FBQUMsTUFBQUEsRUFDQSxLQUFBQyxZQUFBQSxFQUNBLEtBQUFDLE9BQUFBLEVBQ0EsS0FBQUMsT0FBQUEsQ0FDTixFQ1RMLE1BQU1DLEVBQU4sY0FDWSxLQUFBQyxVQUEyQixFQUl2QyxDQUhFQyxZQUFZQyxHQUNWWixLQUFLVSxVQUFVRyxLQUFLRCxFQUN0QixFQU1GLE1BQU1FLFVBQXFCTCxFQUl6QixjQUNFTSxRQUpNLEtBQUFDLFNBQXNCLEVBSzlCLENBQ0FDLHFCQUNFLE9BQUlqQixLQUFLa0IsV0FHUGxCLEtBQUtrQixTQUFXLElBQUlKLEdBRmJkLEtBQUtrQixRQUtoQixDQUNBQyxXQUFXZCxFQUFlQyxFQUFxQkMsR0FDN0MsTUFBTUgsRUFBS2dCLEtBQUtDLFNBQVNDLFdBQ25CQyxFQUFVLElBQUlyQixFQUNsQkUsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQU4sRUFBY3VCLFFBRWhCeEIsS0FBS2dCLFNBQVNILEtBQUtVLEdBQ25CdkIsS0FBS3lCLGtCQUNQLENBRUFDLFlBQVlDLEVBQWVDLEdBQ3pCLE1BQU1DLEVBQU03QixLQUFLZ0IsU0FBU2MsTUFBTUQsR0FBUUEsRUFBSXpCLEtBQU91QixJQUMvQ0UsR0FBT0EsRUFBSXJCLFNBQVdvQixJQUN4QkMsRUFBSXJCLE9BQVNvQixFQUNiNUIsS0FBS3lCLG1CQUVULENBQ0FNLGNBQWNKLEdBQ1ozQixLQUFLZ0IsU0FBV2hCLEtBQUtnQixTQUFTZ0IsUUFBUVQsR0FBWUEsRUFBUW5CLEtBQU91QixJQUNqRTNCLEtBQUt5QixrQkFDUCxDQUVRQSxtQkFDTixJQUFLLE1BQU1iLEtBQWNaLEtBQUtVLFVBQzVCRSxFQUFXWixLQUFLZ0IsU0FBU2lCLFFBRTdCLEVBR0ssTUFBTUMsRUFBZXBCLEVBQWFxQixjQ2xEbEMsU0FBU0MsRUFBU0MsR0FDdkIsT0FBSUEsRUFBaUJDLFVBQzhCLElBQTdDRCxFQUFpQjFDLE1BQU0yQixXQUFXaUIsT0FDN0IscUJBSXFCLE1BQTlCRixFQUFpQkcsV0FDaUIsaUJBQTNCSCxFQUFpQjFDLE9BRXBCMEMsRUFBaUIxQyxNQUFNNEMsT0FBU0YsRUFBaUJHLFVBQzVDLDZDQUE2Q0gsRUFBaUJHLGFBSXpDLE1BQTlCSCxFQUFpQkksV0FDaUIsaUJBQTNCSixFQUFpQjFDLE9BRXBCMEMsRUFBaUIxQyxNQUFNNEMsT0FBU0YsRUFBaUJJLFVBQzVDLDZDQUE2Q0osRUFBaUJJLGFBSS9DLE1BQXhCSixFQUFpQkssS0FDa0IsaUJBQTNCTCxFQUFpQjFDLFFBRXBCMEMsRUFBaUIxQyxNQUFRMEMsRUFBaUJLLElBQ3RDLG1EQUFtREwsRUFBaUJLLE9BSXJELE1BQXhCTCxFQUFpQk0sS0FDa0IsaUJBQTNCTixFQUFpQjFDLFFBRXBCMEMsRUFBaUIxQyxNQUFRMEMsRUFBaUJNLElBQ3RDLGdEQUFnRE4sRUFBaUJNLE9BSXJFLEVBQ1QsQ0NqRE8sTUFBZUMsRUFJcEJ6QyxZQUNVMEMsRUFDQUMsRUFDQUMsRUFDQUMsR0FIQSxLQUFBSCxXQUFBQSxFQUNBLEtBQUFDLGNBQUFBLEVBQ0EsS0FBQUMsY0FBQUEsRUFDQSxLQUFBQyxhQUFBQSxFQUVSaEQsS0FBS2lELGdCQUFrQkMsU0FBU0MsZUFDOUJuRCxLQUFLNkMsWUFFUDdDLEtBQUtvRCxZQUFjRixTQUFTQyxlQUFlbkQsS0FBSzhDLGVBRWhELE1BQU1PLEVBQWVILFNBQVNJLFdBQzVCdEQsS0FBS2lELGdCQUFnQk0sU0FDckIsR0FFRnZELEtBQUt3RCxRQUFVSCxFQUFhSSxrQkFDeEJ6RCxLQUFLZ0QsZUFBY2hELEtBQUt3RCxRQUFRcEQsR0FBS0osS0FBS2dELGNBRTlDaEQsS0FBSzBELFFBQ1AsQ0FHUUEsU0FDTjFELEtBQUtvRCxZQUFZTyxzQkFDZjNELEtBQUsrQyxjQUFnQixhQUFlLFlBQ3BDL0MsS0FBS3dELFFBRVQsRUMxQkssTUFBTUksVUFBcUJoQixFQVFoQ3pDLGNBQ0VZLE1BQU0sZ0JBQWlCLE9BQU8sRUFBTSxjQUVwQ2YsS0FBSzZELGtCQUFvQjdELEtBQUt3RCxRQUFRTSxjQUNwQyxVQUVGOUQsS0FBSytELHdCQUEwQi9ELEtBQUt3RCxRQUFRTSxjQUMxQyxnQkFFRjlELEtBQUtnRSxtQkFBcUJoRSxLQUFLd0QsUUFBUU0sY0FDckMsV0FFRjlELEtBQUtpRSxrQkFBb0JqRSxLQUFLd0QsUUFBUU0sY0FDcEMsZ0JBRUY5RCxLQUFLa0Usd0JBQTBCbEUsS0FBS3dELFFBQVFNLGNBQzFDLHNCQUVGOUQsS0FBS21FLG1CQUFxQm5FLEtBQUt3RCxRQUFRTSxjQUNyQyxpQkFHRjlELEtBQUtvRSxXQUNQLENBQ0FBLFlBQ0VwRSxLQUFLd0QsUUFBUWEsaUJBQWlCLFNBQVVyRSxLQUFLc0UsY0FDL0MsQ0FDQUMsZ0JBQXVCLENBQ2ZDLGtCQUNOLE1BQU1DLEVBQWdCekUsS0FBSzZELGtCQUFrQmxFLE1BQU0rRSxPQUM3Q0MsRUFBcUIzRSxLQUFLK0Qsd0JBQXdCcEUsTUFBTStFLE9BQ3hERSxFQUFnQjVFLEtBQUtnRSxtQkFBbUJyRSxNQUFNK0UsT0FDOUNHLEVBQThCLENBQ2xDbEYsTUFBTzhFLEVBQ1BuQyxVQUFVLEVBQ1ZFLFVBQVcsRUFDWEMsVUFBVyxJQUVQcUMsRUFBb0MsQ0FDeENuRixNQUFPZ0YsRUFDUHJDLFVBQVUsRUFDVkUsVUFBVyxFQUNYQyxVQUFXLElBRVBzQyxFQUErQixDQUNuQ3BGLE1BQU9pRixFQUNQdEMsVUFBVSxFQUNWSSxJQUFLLEVBQ0xDLElBQUssR0FHUCxLQUNFUCxFQUFTeUMsSUFDVHpDLEVBQVMwQyxJQUNUMUMsRUFBUzJDLElBUVQsTUFBTyxDQUFDTixFQUFlRSxHQUFxQkMsR0FONUM1RSxLQUFLZ0YsZ0JBQ0g1QyxFQUFTeUMsR0FDVHpDLEVBQVMwQyxHQUNUMUMsRUFBUzJDLEdBS2YsQ0FDUUMsZ0JBQ05DLEVBQ0FDLEVBQ0FDLEdBRUFuRixLQUFLb0YsY0FDREgsSUFDRmpGLEtBQUtpRSxrQkFBa0JvQixZQUFjSixHQUVuQ0MsSUFDRmxGLEtBQUtrRSx3QkFBd0JtQixZQUFjSCxHQUV6Q0MsSUFDRm5GLEtBQUttRSxtQkFBbUJrQixZQUFjRixFQUUxQyxDQUNRQyxjQUNOcEYsS0FBS2lFLGtCQUFrQm9CLFlBQWMsR0FDckNyRixLQUFLa0Usd0JBQXdCbUIsWUFBYyxHQUMzQ3JGLEtBQUttRSxtQkFBbUJrQixZQUFjLEVBQ3hDLENBRVFDLGNBQ050RixLQUFLNkQsa0JBQWtCbEUsTUFBUSxHQUMvQkssS0FBSytELHdCQUF3QnBFLE1BQVEsR0FDckNLLEtBQUtnRSxtQkFBbUJyRSxNQUFRLEVBQ2xDLENBRVEyRSxjQUFjaUIsR0FDcEJBLEVBQU1DLGlCQUNOLE1BQU1DLEVBQVl6RixLQUFLd0Usa0JBQ3ZCLEdBQUlrQixNQUFNQyxRQUFRRixHQUFZLENBQzVCLE1BQU9wRixFQUFPQyxFQUFhQyxHQUFVa0YsRUFDckN2RCxFQUFhZixXQUFXZCxFQUFPQyxFQUFhQyxHQUM1Q1AsS0FBS3NGLGNBQ0x0RixLQUFLb0YsYSxDQUVULEcsMFRBVFEsRUFEUDlGLEcsNFdDbkdJLE1BQU1zRyxVQUNIaEQsRUFNUnpDLFlBQVkwRixFQUFnQnRFLEdBQzFCUixNQUFNLGlCQUFrQjhFLEdBQVEsRUFBT3RFLEVBQVFuQixJQXVDakQsS0FBQTBGLGlCQUFvQlAsSUFFbEIsR0FEQUEsRUFBTUMsaUJBQ0ZJLEVBQVlHLGFBQWMsQ0FDNUIsTUFBTUMsRUFBUVQsRUFBTVUsUUFBUSxHQUd0QkMsRUFBT0YsRUFBTUcsUUFDYkMsRUFBT0osRUFBTUssUUFHbkJULEVBQVlHLGFBQWFPLE1BQU1DLEtBQU9MLEVBQU8sS0FDN0NOLEVBQVlHLGFBQWFPLE1BQU1FLElBQU1KLEVBQU8sS0FFNUMsTUFBTUssRUFBcUJ2RCxTQUFTQyxlQUNsQyx3QkFFSXVELEVBQXVCeEQsU0FBU0MsZUFDcEMsMEJBR0ZzRCxFQUFvQkUsVUFBVUMsT0FBTyxhQUNyQ0YsRUFBc0JDLFVBQVVDLE9BQU8sYUFHdkMsTUFBTUMsRUFBUzNELFNBQVM0RCxpQkFBaUJaLEVBQU1FLEdBR3pDVyxFQUFpQk4sRUFBb0JPLFNBQVNILEdBQzlDSSxFQUFtQlAsRUFBc0JNLFNBQVNILEdBR3BERSxFQUNGTixFQUFvQkUsVUFBVU8sSUFBSSxhQUN6QkQsR0FDVFAsRUFBc0JDLFVBQVVPLElBQUksWSxHQXhFeENsSCxLQUFLdUIsUUFBVUEsRUFDZnZCLEtBQUtvRSxZQUNMcEUsS0FBS3VFLGVBQ1AsQ0FDSTRDLGFBQ0YsT0FBNEIsSUFBeEJuSCxLQUFLdUIsUUFBUWhCLE9BQ1IsaUJBQWlCUCxLQUFLdUIsUUFBUWhCLE9BQU9lLDhCQUV2QyxpQkFBaUJ0QixLQUFLdUIsUUFBUWhCLE9BQU9lLDZCQUM5QyxDQUVBOEYsaUJBQWlCN0IsR0FLZixHQUpJQSxhQUFpQjhCLFlBQ25COUIsRUFBTStCLGFBQWNDLFFBQVEsYUFBY3ZILEtBQUt1QixRQUFRbkIsSUFDdkRtRixFQUFNK0IsYUFBY0UsY0FBZ0IsUUFFbENqQyxhQUFpQmtDLFdBQVksQ0FDL0IsTUFBTWpFLEVBQVUrQixFQUFNc0IsT0FDdEIsR0FBd0IsV0FBcEJyRCxFQUFRa0UsY0FDTCxHQUF3QixPQUFwQmxFLEVBQVFrRSxRQUFrQixDQUNuQyxNQUFNQyxFQUFLbkUsRUFBUW9FLGNBQWVBLGNBQWV4SCxHQUFHeUgsTUFBTSxLQUFLLEdBQy9EakMsRUFBWXBGLE9BQVNtSCxFQUNyQi9CLEVBQVlHLGFBQWV2QyxFQUFRb0UsYSxLQUM5QixDQUNMLE1BQU1ELEVBQUtuRSxFQUFRb0UsY0FBZXhILEdBQUd5SCxNQUFNLEtBQUssR0FDaERqQyxFQUFZcEYsT0FBU21ILEVBQ3JCL0IsRUFBWUcsYUFBZXZDLEMsQ0FFekJvQyxFQUFZRyxlQUNkSCxFQUFZRyxhQUFhTyxNQUFNd0IsT0FDN0JsQyxFQUFZRyxhQUFhZ0MsYUFBYXpHLFdBQ3hDc0UsRUFBWUcsYUFBYU8sTUFBTTBCLE1BQzdCcEMsRUFBWUcsYUFBYWtDLFlBQVkzRyxXQUN2Q3NFLEVBQVlHLGFBQWFPLE1BQU00QixTQUFXLFFBQzFDdEMsRUFBWUcsYUFBYU8sTUFBTTZCLE9BQVMsTSxDQUc5QyxDQXdDQUMsZUFBZTdJLEdBQXFCLENBRXBDNkUsWUFDRXBFLEtBQUt3RCxRQUFRYSxpQkFBaUIsWUFBYXJFLEtBQUtvSCxrQkFDaERwSCxLQUFLd0QsUUFBUWEsaUJBQWlCLGFBQWNyRSxLQUFLb0gsa0JBQ2pEcEgsS0FBS3dELFFBQVFhLGlCQUFpQixZQUFhckUsS0FBSzhGLGtCQUNoRDlGLEtBQUt3RCxRQUFRYSxpQkFBaUIsVUFBV3JFLEtBQUtvSSxnQkFDOUNwSSxLQUFLd0QsUUFDRk0sY0FBYyxVQUNkTyxpQkFBaUIsUUFBU3JFLEtBQUtxSSxXQUNwQyxDQUNBOUQsZ0JBQ0V2RSxLQUFLd0QsUUFBUU0sY0FDWCxNQUNDdUIsWUFBYyxVQUFVckYsS0FBS3VCLFFBQVFsQixRQUN4Q0wsS0FBS3dELFFBQVFNLGNBQWMsTUFBT3VCLFlBQWNyRixLQUFLbUgsT0FDckRuSCxLQUFLd0QsUUFBUU0sY0FBYyxVQUFXdUIsWUFBYyxTQUNwRHJGLEtBQUt3RCxRQUFRTSxjQUFjLFVBQVcxRCxHQUFLSixLQUFLdUIsUUFBUW5CLEdBQ3hESixLQUFLd0QsUUFBUU0sY0FDWCxLQUNDdUIsWUFBYyxpQkFBaUJyRixLQUFLdUIsUUFBUWpCLGFBQ2pELENBRUErSCxhQUNFbkcsRUFBYUgsY0FBYy9CLEtBQUt1QixRQUFRbkIsR0FDMUMsRUEzRkEsR0FEQ2QsRyxxQ0EwRkQsR0FEQ0EsRyx5V0MzR0ksTUFBTWdKLFVBQ0gxRixFQUlSekMsWUFBb0JvSSxHQUNsQnhILE1BQU0sZUFBZ0IsT0FBTyxFQUFPLEdBQUd3SCxjQURyQixLQUFBQSxLQUFBQSxFQUVsQnZJLEtBQUt3SSxlQUFpQixHQUV0QnhJLEtBQUtvRSxZQUNMcEUsS0FBS3VFLGVBQ1AsQ0FFQWtFLGdCQUFnQmxELEdBQ1ZBLEVBQU0rQixjQUFnRCxlQUFoQy9CLEVBQU0rQixhQUFhb0IsTUFBTSxLQUNqRG5ELEVBQU1DLGlCQUNZeEYsS0FBS3dELFFBQVFNLGNBQWMsTUFDbkM2QyxVQUFVTyxJQUFJLGFBRTVCLENBRUF5QixZQUFZcEQsR0FDVixHQUFJQSxhQUFpQjhCLFVBQVcsQ0FDOUIsTUFBTTFGLEVBQVE0RCxFQUFNK0IsYUFBY3NCLFFBQVEsY0FDMUMxRyxFQUFhUixZQUNYQyxFQUNjLFdBQWQzQixLQUFLdUksS0FBb0J0SSxFQUFjdUIsT0FBU3ZCLEVBQWM0SSxVLENBR2xFLEdBQUl0RCxhQUFpQmtDLFlBQ2Y3QixFQUFZRyxhQUFjLENBQ1g3QyxTQUFTNEYsaUJBQWlCLE1BQ2hDQyxTQUFRLFNBQVVwQixHQUMzQkEsRUFBR2hCLFVBQVVDLE9BQU8sWUFDdEIsSUFDQSxJQUFJb0MsRUFBYTlGLFNBQVM0RCxpQkFDeEJ2QixFQUFNMEQsZUFBZSxHQUFHOUMsUUFDeEJaLEVBQU0wRCxlQUFlLEdBQUc1QyxTQUcxQixHQUFJMkMsR0FBcUMsT0FBdkJBLEVBQVd0QixRQUFrQixDQUM3Q3NCLEVBQVdFLFlBQVl0RCxFQUFZRyxjQUNuQyxNQUFNcEUsRUFBUWlFLEVBQVlHLGFBQWEzRixHQUNqQ0ksRUFDbUIsV0FBdkJvRixFQUFZcEYsT0FDUlAsRUFBYzRJLFVBQ2Q1SSxFQUFjdUIsT0FDcEJVLEVBQWFSLFlBQVlDLEVBQU9uQixFLENBR2xDLEdBQUl3SSxHQUFxQyxPQUF2QkEsRUFBV3RCLFFBQWtCLENBQzdDc0IsRUFBV3BCLGNBQWV1QixhQUN4QnZELEVBQVlHLGFBQ1ppRCxFQUFXSSxhQUViLE1BQU16SCxFQUFRaUUsRUFBWUcsYUFBYTNGLEdBQ2pDSSxFQUNtQixXQUF2Qm9GLEVBQVlwRixPQUNSUCxFQUFjNEksVUFDZDVJLEVBQWN1QixPQUNwQlUsRUFBYVIsWUFBWUMsRUFBT25CLEUsQ0FHbENvRixFQUFZRyxhQUFhTyxNQUFNQyxLQUFPLEdBQ3RDWCxFQUFZRyxhQUFhTyxNQUFNRSxJQUFNLEdBQ3JDWixFQUFZRyxhQUFhTyxNQUFNd0IsT0FBUyxHQUN4Q2xDLEVBQVlHLGFBQWFPLE1BQU0wQixNQUFRLEdBQ3ZDcEMsRUFBWUcsYUFBYU8sTUFBTTRCLFNBQVcsR0FDMUN0QyxFQUFZRyxhQUFhTyxNQUFNNkIsT0FBUyxFLENBRzlDLENBR0FrQixpQkFBaUI5SixHQUNHUyxLQUFLd0QsUUFBUU0sY0FBYyxNQUNuQzZDLFVBQVVDLE9BQU8sWUFDN0IsQ0FDQXhDLFlBQ0VwRSxLQUFLd0QsUUFBUWEsaUJBQWlCLFdBQVlyRSxLQUFLeUksaUJBQy9DekksS0FBS3dELFFBQVFhLGlCQUFpQixXQUFZckUsS0FBSzJJLGFBQy9DM0ksS0FBS3dELFFBQVFhLGlCQUFpQixPQUFRckUsS0FBSzJJLGFBQzNDM0ksS0FBS3dELFFBQVFhLGlCQUFpQixZQUFhckUsS0FBS3FKLGtCQUNoRG5ILEVBQWF2QixhQUFhSyxJQUN4QixNQUFNc0ksRUFBbUJ0SSxFQUFTZ0IsUUFBUUgsR0FDdEIsV0FBZDdCLEtBQUt1SSxLQUNBMUcsRUFBSXJCLFNBQVdQLEVBQWN1QixPQUU3QkssRUFBSXJCLFNBQVdQLEVBQWM0SSxZQUd4QzdJLEtBQUt3SSxlQUFpQmMsRUFDdEJ0SixLQUFLdUosZ0JBQWdCLEdBRXpCLENBQ0FoRixnQkFDRSxNQUFNaUYsRUFBUyxHQUFHeEosS0FBS3VJLHFCQUN2QnZJLEtBQUt3RCxRQUFRTSxjQUFjLE1BQU8xRCxHQUFLb0osRUFDdkN4SixLQUFLd0QsUUFBUU0sY0FBYyxNQUFPdUIsWUFDaEMsR0FBR3JGLEtBQUt1SSxnQkFBZ0JrQixhQUM1QixDQUNRRixpQkFDWXJHLFNBQVNDLGVBQ3pCLEdBQUduRCxLQUFLdUksc0JBRUFtQixVQUFZLEdBQ3RCLElBQUssTUFBTW5JLEtBQVd2QixLQUFLd0ksZUFDekIsSUFBSTVDLEVBQVk1RixLQUFLd0QsUUFBUU0sY0FBYyxNQUFPMUQsR0FBSW1CLEVBRTFELEVBaEdBLEdBRENqQyxHLG9DQVNELEdBRENBLEcsZ0NBc0RELEdBRENBLEcscUNDNUVILElBQUlzRSxFQUNKLElBQUkwRSxFQUFZLFVBQ2hCLElBQUlBLEVBQVksVyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvdHMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvdHMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50LnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3RzL2NvbXBvbmVudHMvcHJvamVjdC1pdGVtLnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvdHMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBBdXRvYmluZChfOiBhbnksIF8yOiBzdHJpbmcgfCBudW1iZXIsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xyXG4gIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICBjb25zdCBhZGpEZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IgPSB7XHJcbiAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIGdldCgpIHtcclxuICAgICAgY29uc3QgYm91bmRGbiA9IG9yaWdpbmFsTWV0aG9kLmJpbmQodGhpcyk7XHJcbiAgICAgIHJldHVybiBib3VuZEZuO1xyXG4gICAgfSxcclxuICB9O1xyXG4gIHJldHVybiBhZGpEZXNjcmlwdG9yO1xyXG59XHJcbiIsImV4cG9ydCBlbnVtIFByb2plY3RTdGF0dXMge1xyXG4gIEFDVElWRSxcclxuICBGSU5JU0hJRUQsXHJcbn1cclxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIGlkOiBzdHJpbmcsXHJcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcclxuICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG4gICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxyXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xyXG4gICkge31cclxufVxyXG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcbi8vIFN0YXRlIENvbXBvbmVudCAgQ2xhc3NcclxuY2xhc3MgU3RhdGVDb21wb25lbnQ8VD4ge1xyXG4gIHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcclxuICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZuKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFByb2plY3QgU3RhdGUgQ2xhc3NcclxudHlwZSBMaXN0ZW5lcjxUPiA9IChwcm9qZWN0czogVFtdKSA9PiB2b2lkO1xyXG5cclxuY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGVDb21wb25lbnQ8UHJvamVjdD4ge1xyXG4gIHByaXZhdGUgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xyXG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGU7XHJcblxyXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gIH1cclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XHJcbiAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfVxyXG4gIH1cclxuICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHBlb3BsZTogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBpZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKTtcclxuICAgIGNvbnN0IHByb2plY3QgPSBuZXcgUHJvamVjdChcclxuICAgICAgaWQsXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgcGVvcGxlLFxyXG4gICAgICBQcm9qZWN0U3RhdHVzLkFDVElWRVxyXG4gICAgKTtcclxuICAgIHRoaXMucHJvamVjdHMucHVzaChwcm9qZWN0KTtcclxuICAgIHRoaXMudXBkYXRlZExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgbW92ZVByb2plY3QocHJqSWQ6IHN0cmluZywgcHJqc3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XHJcbiAgICBjb25zdCBwcmogPSB0aGlzLnByb2plY3RzLmZpbmQoKHByaikgPT4gcHJqLmlkID09PSBwcmpJZCk7XHJcbiAgICBpZiAocHJqICYmIHByai5zdGF0dXMgIT09IHByanN0YXR1cykge1xyXG4gICAgICBwcmouc3RhdHVzID0gcHJqc3RhdHVzO1xyXG4gICAgICB0aGlzLnVwZGF0ZWRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuICB9XHJcbiAgZGVsZXRlUHJvamVjdChwcmpJZDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnByb2plY3RzID0gdGhpcy5wcm9qZWN0cy5maWx0ZXIoKHByb2plY3QpID0+IHByb2plY3QuaWQgIT09IHByaklkKTtcclxuICAgIHRoaXMudXBkYXRlZExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVkTGlzdGVuZXJzKCkge1xyXG4gICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XHJcbiAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuLy8gSW5zdGFudGlhdGlvblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7XHJcbiIsImV4cG9ydCBpbnRlcmZhY2UgdmFsaWRhdGVUeXBlIHtcclxuICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xyXG4gIHJlcXVpcmVkPzogdHJ1ZSB8IGZhbHNlO1xyXG4gIG1pbkxlbmd0aD86IG51bWJlcjtcclxuICBtYXhMZW5ndGg/OiBudW1iZXI7XHJcbiAgbWluPzogbnVtYmVyO1xyXG4gIG1heD86IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IHZhbGlkYXRlVHlwZSkge1xyXG4gIGlmICh2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKSB7XHJcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gJ1ZhbHVlIGlzIHJlcXVpcmVkLic7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmIChcclxuICAgIHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiZcclxuICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJ1xyXG4gICkge1xyXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoIDwgdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIGBDaGFyYWN0ZXIgc2hvdWxkIGhhdmUgYSBtaW5pbXVtIGxlbmd0aCBvZiAke3ZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RofS5gO1xyXG4gICAgfVxyXG4gIH1cclxuICBpZiAoXHJcbiAgICB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmXHJcbiAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZydcclxuICApIHtcclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA+IHZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoKSB7XHJcbiAgICAgIHJldHVybiBgQ2hhcmFjdGVyIHNob3VsZCBoYXZlIGEgbWF4aW11bSBsZW5ndGggb2YgJHt2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aH0uYDtcclxuICAgIH1cclxuICB9XHJcbiAgaWYgKFxyXG4gICAgdmFsaWRhdGFibGVJbnB1dC5taW4gIT0gbnVsbCAmJlxyXG4gICAgdHlwZW9mICt2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJ1xyXG4gICkge1xyXG4gICAgaWYgKCt2YWxpZGF0YWJsZUlucHV0LnZhbHVlIDwgdmFsaWRhdGFibGVJbnB1dC5taW4pIHtcclxuICAgICAgcmV0dXJuIGBQYXJ0aWNpcGFudHMgc2hvdWxkIGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAke3ZhbGlkYXRhYmxlSW5wdXQubWlufS5gO1xyXG4gICAgfVxyXG4gIH1cclxuICBpZiAoXHJcbiAgICB2YWxpZGF0YWJsZUlucHV0Lm1heCAhPSBudWxsICYmXHJcbiAgICB0eXBlb2YgK3ZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInXHJcbiAgKSB7XHJcbiAgICBpZiAoK3ZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPiB2YWxpZGF0YWJsZUlucHV0Lm1heCkge1xyXG4gICAgICByZXR1cm4gYFBhcnRpY2lwYW50cyBzaG91bGQgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICR7dmFsaWRhdGFibGVJbnB1dC5tYXh9LmA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gJyc7XHJcbn1cclxuIiwiZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD4ge1xyXG4gIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICBob3N0RWxlbWVudDogVDtcclxuICBlbGVtZW50OiBVO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZUlkOiBzdHJpbmcsXHJcbiAgICBwcml2YXRlIGhvc3RFbGVtZW50SWQ6IHN0cmluZyxcclxuICAgIHByaXZhdGUgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcclxuICAgIHByaXZhdGUgbmV3RWxlbWVudElkPzogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gICAgICB0aGlzLnRlbXBsYXRlSWRcclxuICAgICkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5ob3N0RWxlbWVudElkKSEgYXMgVDtcclxuXHJcbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKFxyXG4gICAgICB0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LFxyXG4gICAgICB0cnVlXHJcbiAgICApO1xyXG4gICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkIGFzIFU7XHJcbiAgICBpZiAodGhpcy5uZXdFbGVtZW50SWQpIHRoaXMuZWxlbWVudC5pZCA9IHRoaXMubmV3RWxlbWVudElkO1xyXG5cclxuICAgIHRoaXMuYXR0YWNoKCk7XHJcbiAgfVxyXG4gIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcclxuICBwcml2YXRlIGF0dGFjaCgpIHtcclxuICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFxyXG4gICAgICB0aGlzLmluc2VydEF0U3RhcnQgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJyxcclxuICAgICAgdGhpcy5lbGVtZW50XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBBdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnO1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJztcclxuaW1wb3J0IHsgdmFsaWRhdGUsIHZhbGlkYXRlVHlwZSB9IGZyb20gJy4uL3V0aWwvdmFsaWRhdGlvbic7XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XHJcbiAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIHRpdGxlRXJyb3JFbGVtZW50OiBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICBkZXNjcmlwdGlvbkVycm9yRWxlbWVudDogSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcbiAgcGVvcGxlRXJyb3JFbGVtZW50OiBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsICdhcHAnLCB0cnVlLCAndXNlci1pbnB1dCcpO1xyXG5cclxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJyN0aXRsZSdcclxuICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJyNkZXNjcmlwdGlvbidcclxuICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICcjcGVvcGxlJ1xyXG4gICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgdGhpcy50aXRsZUVycm9yRWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnI3RpdGxlX2Vycm9yJ1xyXG4gICAgKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICAgIHRoaXMuZGVzY3JpcHRpb25FcnJvckVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJyNkZXNjcmlwdGlvbl9lcnJvcidcclxuICAgICkgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcbiAgICB0aGlzLnBlb3BsZUVycm9yRWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnI3Blb3BsZV9lcnJvcidcclxuICAgICkgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICB9XHJcbiAgY29uZmlndXJlKCkge1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlcik7XHJcbiAgfVxyXG4gIHJlbmRlckNvbnRlbnQoKTogdm9pZCB7fVxyXG4gIHByaXZhdGUgZ2F0aGVyVXNlcklucHV0KCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xyXG4gICAgY29uc3QgZW50ZXJlZFRpbHRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpO1xyXG4gICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZS50cmltKCk7XHJcbiAgICBjb25zdCBlbnRlcmVkUHJvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpO1xyXG4gICAgY29uc3QgdGl0bGVWYWxpZGF0ZTogdmFsaWRhdGVUeXBlID0ge1xyXG4gICAgICB2YWx1ZTogZW50ZXJlZFRpbHRsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbkxlbmd0aDogNCxcclxuICAgICAgbWF4TGVuZ3RoOiAxMCxcclxuICAgIH07XHJcbiAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRlOiB2YWxpZGF0ZVR5cGUgPSB7XHJcbiAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBtaW5MZW5ndGg6IDQsXHJcbiAgICAgIG1heExlbmd0aDogMTAsXHJcbiAgICB9O1xyXG4gICAgY29uc3QgcGVvcGxlVmFsaWRhdGU6IHZhbGlkYXRlVHlwZSA9IHtcclxuICAgICAgdmFsdWU6IGVudGVyZWRQcm9wbGUsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBtaW46IDAsXHJcbiAgICAgIG1heDogNSxcclxuICAgIH07XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICB2YWxpZGF0ZSh0aXRsZVZhbGlkYXRlKSB8fFxyXG4gICAgICB2YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRlKSB8fFxyXG4gICAgICB2YWxpZGF0ZShwZW9wbGVWYWxpZGF0ZSlcclxuICAgICkge1xyXG4gICAgICB0aGlzLnNob3dJbnB1dHNFcnJvcihcclxuICAgICAgICB2YWxpZGF0ZSh0aXRsZVZhbGlkYXRlKSxcclxuICAgICAgICB2YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRlKSxcclxuICAgICAgICB2YWxpZGF0ZShwZW9wbGVWYWxpZGF0ZSlcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBbZW50ZXJlZFRpbHRsZSwgZW50ZXJlZERlc2NyaXB0aW9uLCArZW50ZXJlZFByb3BsZV07XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgc2hvd0lucHV0c0Vycm9yKFxyXG4gICAgdGl0bGVFcnJvcjogc3RyaW5nLFxyXG4gICAgZGVzY3JpcHRpb25FcnJvcjogc3RyaW5nLFxyXG4gICAgcGVvcGxlRXJyb3I6IHN0cmluZ1xyXG4gICkge1xyXG4gICAgdGhpcy5jbGVhbkVycm9ycygpO1xyXG4gICAgaWYgKHRpdGxlRXJyb3IpIHtcclxuICAgICAgdGhpcy50aXRsZUVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IHRpdGxlRXJyb3I7XHJcbiAgICB9XHJcbiAgICBpZiAoZGVzY3JpcHRpb25FcnJvcikge1xyXG4gICAgICB0aGlzLmRlc2NyaXB0aW9uRXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb25FcnJvcjtcclxuICAgIH1cclxuICAgIGlmIChwZW9wbGVFcnJvcikge1xyXG4gICAgICB0aGlzLnBlb3BsZUVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IHBlb3BsZUVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcml2YXRlIGNsZWFuRXJyb3JzKCkge1xyXG4gICAgdGhpcy50aXRsZUVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbkVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgdGhpcy5wZW9wbGVFcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2xlYXJJbnB1dHMoKSB7XHJcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gIH1cclxuICBAQXV0b2JpbmRcclxuICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcclxuICAgICAgY29uc3QgW3RpdGxlLCBkZXNjcmlwdGlvbiwgcGVvcGxlXSA9IHVzZXJJbnB1dDtcclxuICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUpO1xyXG4gICAgICB0aGlzLmNsZWFySW5wdXRzKCk7XHJcbiAgICAgIHRoaXMuY2xlYW5FcnJvcnMoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQXV0b2JpbmQgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcclxuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50JztcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbVxyXG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+XHJcbiAgaW1wbGVtZW50cyBEcmFnZ2FibGVcclxue1xyXG4gIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcclxuICBzdGF0aWMgc2VsZWN0ZWRJdGVtOiBIVE1MTElFbGVtZW50IHwgbnVsbDtcclxuICBzdGF0aWMgc3RhdHVzOiBzdHJpbmc7XHJcbiAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcsIHByb2plY3Q6IFByb2plY3QpIHtcclxuICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xyXG4gICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcclxuICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICB9XHJcbiAgZ2V0IHBlcnNvbigpIHtcclxuICAgIGlmICh0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSB7XHJcbiAgICAgIHJldHVybiBgUGFydGljaXBhbnRzOiAke3RoaXMucHJvamVjdC5wZW9wbGUudG9TdHJpbmcoKX0gcGVyc29uIGFzc2lnbmVkLmA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYFBhcnRpY2lwYW50czogJHt0aGlzLnByb2plY3QucGVvcGxlLnRvU3RyaW5nKCl9IHBlb3BsZSBhc3NpZ25lZC5gO1xyXG4gIH1cclxuICBAQXV0b2JpbmRcclxuICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQgfCBUb3VjaEV2ZW50KTogdm9pZCB7XHJcbiAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBEcmFnRXZlbnQpIHtcclxuICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5wcm9qZWN0LmlkKTtcclxuICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xyXG4gICAgfVxyXG4gICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCkge1xyXG4gICAgICBjb25zdCBlbGVtZW50ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICBpZiAoZWxlbWVudC50YWdOYW1lID09PSAnQlVUVE9OJykge1xyXG4gICAgICB9IGVsc2UgaWYgKGVsZW1lbnQudGFnTmFtZSAhPT0gJ0xJJykge1xyXG4gICAgICAgIGNvbnN0IHVsID0gZWxlbWVudC5wYXJlbnRFbGVtZW50IS5wYXJlbnRFbGVtZW50IS5pZC5zcGxpdCgnLScpWzBdO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnN0YXR1cyA9IHVsO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbSA9IGVsZW1lbnQucGFyZW50RWxlbWVudCBhcyBIVE1MTElFbGVtZW50O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IHVsID0gZWxlbWVudC5wYXJlbnRFbGVtZW50IS5pZC5zcGxpdCgnLScpWzBdO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnN0YXR1cyA9IHVsO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbSA9IGVsZW1lbnQgYXMgSFRNTExJRWxlbWVudDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtKSB7XHJcbiAgICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLmhlaWdodCA9XHJcbiAgICAgICAgICBQcm9qZWN0SXRlbS5zZWxlY3RlZEl0ZW0uY2xpZW50SGVpZ2h0LnRvU3RyaW5nKCk7XHJcbiAgICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLndpZHRoID1cclxuICAgICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbS5jbGllbnRXaWR0aC50b1N0cmluZygpO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbS5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XHJcbiAgICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLnpJbmRleCA9ICctMTAnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIFRvdWNoTW92ZUhhbmRsZXIgPSAoZXZlbnQ6IFRvdWNoRXZlbnQpID0+IHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vIFByZXZlbnQgZGVmYXVsdCB0b3VjaG1vdmUgYmVoYXZpb3JcclxuICAgIGlmIChQcm9qZWN0SXRlbS5zZWxlY3RlZEl0ZW0pIHtcclxuICAgICAgY29uc3QgdG91Y2ggPSBldmVudC50b3VjaGVzWzBdO1xyXG5cclxuICAgICAgLy8gVXBkYXRlIHRoZSB4UG9zIGFuZCB5UG9zIHdpdGggdGhlIHRvdWNoIHBvc2l0aW9uXHJcbiAgICAgIGNvbnN0IHhQb3MgPSB0b3VjaC5jbGllbnRYO1xyXG4gICAgICBjb25zdCB5UG9zID0gdG91Y2guY2xpZW50WTtcclxuXHJcbiAgICAgIC8vIFVwZGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGVsZW1lbnRcclxuICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLmxlZnQgPSB4UG9zICsgJ3B4JztcclxuICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLnRvcCA9IHlQb3MgKyAncHgnO1xyXG5cclxuICAgICAgY29uc3QgYWN0aXZlUHJvamVjdHNMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgICAgICAgJ2FjdGl2ZS1wcm9qZWN0cy1saXN0J1xyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBmaW5pc2hlZFByb2plY3RzTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gICAgICAgICdmaW5pc2hlZC1wcm9qZWN0cy1saXN0J1xyXG4gICAgICApO1xyXG5cclxuICAgICAgYWN0aXZlUHJvamVjdHNMaXN0IS5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKTtcclxuICAgICAgZmluaXNoZWRQcm9qZWN0c0xpc3QhLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xyXG5cclxuICAgICAgLy8gRmluZCB0aGUgdGFyZ2V0IGVsZW1lbnQgYmFzZWQgb24gdGhlIHRvdWNoIHBvc2l0aW9uXHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeFBvcywgeVBvcyk7XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0IGxpc3RzIGFyZSB0aGUgYWN0aXZlIHByb2plY3RzIGxpc3QgYW5kIGZpbmlzaGVkIHByb2plY3RzIGxpc3RcclxuICAgICAgY29uc3QgaXNUYXJnZXRBY3RpdmUgPSBhY3RpdmVQcm9qZWN0c0xpc3QhLmNvbnRhaW5zKHRhcmdldCk7XHJcbiAgICAgIGNvbnN0IGlzVGFyZ2V0RmluaXNoZWQgPSBmaW5pc2hlZFByb2plY3RzTGlzdCEuY29udGFpbnModGFyZ2V0KTtcclxuXHJcbiAgICAgIC8vIENoYW5nZSB0aGUgc3R5bGUgb2YgdGhlIHRhcmdldCBsaXN0c1xyXG4gICAgICBpZiAoaXNUYXJnZXRBY3RpdmUpIHtcclxuICAgICAgICBhY3RpdmVQcm9qZWN0c0xpc3QhLmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xyXG4gICAgICB9IGVsc2UgaWYgKGlzVGFyZ2V0RmluaXNoZWQpIHtcclxuICAgICAgICBmaW5pc2hlZFByb2plY3RzTGlzdCEuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG5cclxuICBkcmFnRW5kSGFuZGxlcihfOiBEcmFnRXZlbnQpOiB2b2lkIHt9XHJcblxyXG4gIGNvbmZpZ3VyZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuVG91Y2hNb3ZlSGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCdidXR0b24nKSFcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5kZWxldGVJdGVtKTtcclxuICB9XHJcbiAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnaDInXHJcbiAgICApIS50ZXh0Q29udGVudCA9IGBUaXRsZTogJHt0aGlzLnByb2plY3QudGl0bGV9YDtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29uO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpIS50ZXh0Q29udGVudCA9ICdEZWxldGUnO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpIS5pZCA9IHRoaXMucHJvamVjdC5pZDtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAncCdcclxuICAgICkhLnRleHRDb250ZW50ID0gYERlc2NyaXB0aW9uOiAgJHt0aGlzLnByb2plY3QuZGVzY3JpcHRpb259YDtcclxuICB9XHJcbiAgQEF1dG9iaW5kXHJcbiAgZGVsZXRlSXRlbSgpOiB2b2lkIHtcclxuICAgIHByb2plY3RTdGF0ZS5kZWxldGVQcm9qZWN0KHRoaXMucHJvamVjdC5pZCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJztcclxuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdC1zdGF0ZSc7XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gJy4vcHJvamVjdC1pdGVtJztcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdFxyXG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD5cclxuICBpbXBsZW1lbnRzIERyYWdUYXJnZXRcclxue1xyXG4gIGFzc2lnblByb2plY3RzOiBQcm9qZWN0W107XHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcclxuICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCAnYXBwJywgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYCk7XHJcbiAgICB0aGlzLmFzc2lnblByb2plY3RzID0gW107XHJcblxyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gIH1cclxuICBAQXV0b2JpbmRcclxuICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgaWYgKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJykge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCB1bEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgICAgdWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xyXG4gICAgfVxyXG4gIH1cclxuICBAQXV0b2JpbmRcclxuICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50IHwgVG91Y2hFdmVudCk6IHZvaWQge1xyXG4gICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgRHJhZ0V2ZW50KSB7XHJcbiAgICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChcclxuICAgICAgICBwcmpJZCxcclxuICAgICAgICB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BQ1RJVkUgOiBQcm9qZWN0U3RhdHVzLkZJTklTSElFRFxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCkge1xyXG4gICAgICBpZiAoUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtKSB7XHJcbiAgICAgICAgdmFyIHVsRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCd1bCcpO1xyXG4gICAgICAgIHVsRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAodWwpIHtcclxuICAgICAgICAgIHVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0YXJnZXRMaXN0ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChcclxuICAgICAgICAgIGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFgsXHJcbiAgICAgICAgICBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZXHJcbiAgICAgICAgKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0IGlzIGEgPHVsPiBlbGVtZW50XHJcbiAgICAgICAgaWYgKHRhcmdldExpc3QgJiYgdGFyZ2V0TGlzdC50YWdOYW1lID09PSAnVUwnKSB7XHJcbiAgICAgICAgICB0YXJnZXRMaXN0LmFwcGVuZENoaWxkKFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbSk7IC8vIE1vdmUgdGhlIHNlbGVjdGVkIDxsaT4gZWxlbWVudCB0byB0aGUgdGFyZ2V0IDx1bD5cclxuICAgICAgICAgIGNvbnN0IHByaklkID0gUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLmlkO1xyXG4gICAgICAgICAgY29uc3Qgc3RhdHVzID1cclxuICAgICAgICAgICAgUHJvamVjdEl0ZW0uc3RhdHVzID09PSAnYWN0aXZlJ1xyXG4gICAgICAgICAgICAgID8gUHJvamVjdFN0YXR1cy5GSU5JU0hJRURcclxuICAgICAgICAgICAgICA6IFByb2plY3RTdGF0dXMuQUNUSVZFO1xyXG4gICAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByaklkLCBzdGF0dXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0IGlzIGEgPGxpPiBlbGVtZW50XHJcbiAgICAgICAgaWYgKHRhcmdldExpc3QgJiYgdGFyZ2V0TGlzdC50YWdOYW1lID09PSAnTEknKSB7XHJcbiAgICAgICAgICB0YXJnZXRMaXN0LnBhcmVudEVsZW1lbnQhLmluc2VydEJlZm9yZShcclxuICAgICAgICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLFxyXG4gICAgICAgICAgICB0YXJnZXRMaXN0Lm5leHRTaWJsaW5nXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29uc3QgcHJqSWQgPSBQcm9qZWN0SXRlbS5zZWxlY3RlZEl0ZW0uaWQ7XHJcbiAgICAgICAgICBjb25zdCBzdGF0dXMgPVxyXG4gICAgICAgICAgICBQcm9qZWN0SXRlbS5zdGF0dXMgPT09ICdhY3RpdmUnXHJcbiAgICAgICAgICAgICAgPyBQcm9qZWN0U3RhdHVzLkZJTklTSElFRFxyXG4gICAgICAgICAgICAgIDogUHJvamVjdFN0YXR1cy5BQ1RJVkU7XHJcbiAgICAgICAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QocHJqSWQsIHN0YXR1cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFJlc2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgc2VsZWN0ZWQgPGxpPiBlbGVtZW50XHJcbiAgICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLmxlZnQgPSAnJztcclxuICAgICAgICBQcm9qZWN0SXRlbS5zZWxlY3RlZEl0ZW0uc3R5bGUudG9wID0gJyc7XHJcbiAgICAgICAgUHJvamVjdEl0ZW0uc2VsZWN0ZWRJdGVtLnN0eWxlLmhlaWdodCA9ICcnO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbS5zdHlsZS53aWR0aCA9ICcnO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbS5zdHlsZS5wb3NpdGlvbiA9ICcnO1xyXG4gICAgICAgIFByb2plY3RJdGVtLnNlbGVjdGVkSXRlbS5zdHlsZS56SW5kZXggPSAnJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQEF1dG9iaW5kXHJcbiAgZHJhZ0xlYXZlSGFuZGxlcihfOiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHVsRWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgdWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xyXG4gIH1cclxuICBjb25maWd1cmUoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLmRyb3BIYW5kbGVyKTtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcclxuICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xyXG4gICAgICBjb25zdCByZWxldmFudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKChwcmo6IFByb2plY3QpID0+IHtcclxuICAgICAgICBpZiAodGhpcy50eXBlID09PSAnYWN0aXZlJykge1xyXG4gICAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuQUNUSVZFO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5GSU5JU0hJRUQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5hc3NpZ25Qcm9qZWN0cyA9IHJlbGV2YW50UHJvamVjdHM7XHJcbiAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICByZW5kZXJDb250ZW50KCk6IHZvaWQge1xyXG4gICAgY29uc3QgbGlzdGlkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YDtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCA9IGxpc3RpZDtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9XHJcbiAgICAgIGAke3RoaXMudHlwZX0gcHJvamVjdHNgLnRvVXBwZXJDYXNlKCk7XHJcbiAgfVxyXG4gIHByaXZhdGUgcmVuZGVyUHJvamVjdHMoKSB7XHJcbiAgICBjb25zdCB1bEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICAgICAgYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YFxyXG4gICAgKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgIHVsRWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgIGZvciAoY29uc3QgcHJvamVjdCBvZiB0aGlzLmFzc2lnblByb2plY3RzKSB7XHJcbiAgICAgIG5ldyBQcm9qZWN0SXRlbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQsIHByb2plY3QpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCc7XG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0XCI7XG5cbi8vIEluc3RhbnRpYXRpb25cbm5ldyBQcm9qZWN0SW5wdXQoKTtcbm5ldyBQcm9qZWN0TGlzdCgnYWN0aXZlJyk7XG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XG4iXSwibmFtZXMiOlsiQXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJiaW5kIiwidGhpcyIsIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJTdGF0ZUNvbXBvbmVudCIsImxpc3RlbmVycyIsImFkZExpc3RlbmVyIiwibGlzdGVuZXJGbiIsInB1c2giLCJQcm9qZWN0U3RhdGUiLCJzdXBlciIsInByb2plY3RzIiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwicHJvamVjdCIsIkFDVElWRSIsInVwZGF0ZWRMaXN0ZW5lcnMiLCJtb3ZlUHJvamVjdCIsInByaklkIiwicHJqc3RhdHVzIiwicHJqIiwiZmluZCIsImRlbGV0ZVByb2plY3QiLCJmaWx0ZXIiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwidmFsaWRhdGUiLCJ2YWxpZGF0YWJsZUlucHV0IiwicmVxdWlyZWQiLCJsZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJDb21wb25lbnQiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsZW1lbnQiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImF0dGFjaCIsImluc2VydEFkamFjZW50RWxlbWVudCIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwicGVvcGxlSW5wdXRFbGVtZW50IiwidGl0bGVFcnJvckVsZW1lbnQiLCJkZXNjcmlwdGlvbkVycm9yRWxlbWVudCIsInBlb3BsZUVycm9yRWxlbWVudCIsImNvbmZpZ3VyZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdWJtaXRIYW5kbGVyIiwicmVuZGVyQ29udGVudCIsImdhdGhlclVzZXJJbnB1dCIsImVudGVyZWRUaWx0bGUiLCJ0cmltIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFByb3BsZSIsInRpdGxlVmFsaWRhdGUiLCJkZXNjcmlwdGlvblZhbGlkYXRlIiwicGVvcGxlVmFsaWRhdGUiLCJzaG93SW5wdXRzRXJyb3IiLCJ0aXRsZUVycm9yIiwiZGVzY3JpcHRpb25FcnJvciIsInBlb3BsZUVycm9yIiwiY2xlYW5FcnJvcnMiLCJ0ZXh0Q29udGVudCIsImNsZWFySW5wdXRzIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwiVG91Y2hNb3ZlSGFuZGxlciIsInNlbGVjdGVkSXRlbSIsInRvdWNoIiwidG91Y2hlcyIsInhQb3MiLCJjbGllbnRYIiwieVBvcyIsImNsaWVudFkiLCJzdHlsZSIsImxlZnQiLCJ0b3AiLCJhY3RpdmVQcm9qZWN0c0xpc3QiLCJmaW5pc2hlZFByb2plY3RzTGlzdCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRhcmdldCIsImVsZW1lbnRGcm9tUG9pbnQiLCJpc1RhcmdldEFjdGl2ZSIsImNvbnRhaW5zIiwiaXNUYXJnZXRGaW5pc2hlZCIsImFkZCIsInBlcnNvbiIsImRyYWdTdGFydEhhbmRsZXIiLCJEcmFnRXZlbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsIlRvdWNoRXZlbnQiLCJ0YWdOYW1lIiwidWwiLCJwYXJlbnRFbGVtZW50Iiwic3BsaXQiLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJ3aWR0aCIsImNsaWVudFdpZHRoIiwicG9zaXRpb24iLCJ6SW5kZXgiLCJkcmFnRW5kSGFuZGxlciIsImRlbGV0ZUl0ZW0iLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25Qcm9qZWN0cyIsImRyYWdPdmVySGFuZGxlciIsInR5cGVzIiwiZHJvcEhhbmRsZXIiLCJnZXREYXRhIiwiRklOSVNISUVEIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJ0YXJnZXRMaXN0IiwiY2hhbmdlZFRvdWNoZXMiLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsIm5leHRTaWJsaW5nIiwiZHJhZ0xlYXZlSGFuZGxlciIsInJlbGV2YW50UHJvamVjdHMiLCJyZW5kZXJQcm9qZWN0cyIsImxpc3RpZCIsInRvVXBwZXJDYXNlIiwiaW5uZXJIVE1MIl0sInNvdXJjZVJvb3QiOiIifQ==