(()=>{"use strict";function e(e,t,r){const n=r.value;return{configurable:!0,enumerable:!1,get(){return n.bind(this)}}}var t;!function(e){e[e.ACTIVE=0]="ACTIVE",e[e.FINISHIED=1]="FINISHIED"}(t||(t={}));class r{constructor(e,t,r,n,s){this.id=e,this.title=t,this.description=r,this.people=n,this.status=s}}class n{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class s extends n{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new s),this.instance}addProject(e,n,s){const i=Math.random().toString(),o=new r(i,e,n,s,t.ACTIVE);this.projects.push(o),this.updatedListeners()}moveProject(e,t){const r=this.projects.find((t=>t.id===e));r&&r.status!==t&&(r.status=t,this.updatedListeners())}deleteProject(e){this.projects=this.projects.filter((t=>t.id!==e)),this.updatedListeners()}updatedListeners(){for(const e of this.listeners)e(this.projects.slice())}}const i=s.getInstance();function o(e){return e.required&&0===e.value.toString().length?"Value is required.":null!=e.minLength&&"string"==typeof e.value&&e.value.length<e.minLength?`Character should have a minimum length of ${e.minLength}.`:null!=e.maxLength&&"string"==typeof e.value&&e.value.length>e.maxLength?`Character should have a maximum length of ${e.maxLength}.`:null!=e.min&&"number"==typeof+e.value&&+e.value<e.min?`Participants should be greater than or equal to ${e.min}.`:null!=e.max&&"number"==typeof+e.value&&+e.value>e.max?`Participants should be less than or equal to ${e.max}.`:""}class l{constructor(e,t,r,n){this.templateId=e,this.hostElementId=t,this.insertAtStart=r,this.newElementId=n,this.templateElement=document.getElementById(this.templateId),this.hostElement=document.getElementById(this.hostElementId);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,this.newElementId&&(this.element.id=this.newElementId),this.attach()}attach(){this.hostElement.insertAdjacentElement(this.insertAtStart?"afterbegin":"beforeend",this.element)}}class a extends l{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.titleErrorElement=this.element.querySelector("#title_error"),this.descriptionErrorElement=this.element.querySelector("#description_error"),this.peopleErrorElement=this.element.querySelector("#people_error"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value.trim(),t=this.descriptionInputElement.value.trim(),r=this.peopleInputElement.value.trim(),n={value:e,required:!0,minLength:4,maxLength:10},s={value:t,required:!0,minLength:4,maxLength:10},i={value:r,required:!0,min:0,max:5};if(!(o(n)||o(s)||o(i)))return[e,t,+r];this.showInputsError(o(n),o(s),o(i))}showInputsError(e,t,r){this.cleanErrors(),e&&(this.titleErrorElement.textContent=e),t&&(this.descriptionErrorElement.textContent=t),r&&(this.peopleErrorElement.textContent=r)}cleanErrors(){this.titleErrorElement.textContent="",this.descriptionErrorElement.textContent="",this.peopleErrorElement.textContent=""}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,r,n]=t;i.addProject(e,r,n),this.clearInputs(),this.cleanErrors()}}}!function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);i>3&&o&&Object.defineProperty(t,r,o)}([e],a.prototype,"submitHandler",null);var c=function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};class h extends l{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get person(){return 1===this.project.people?`Participants: ${this.project.people.toString()} person assigned.`:`Participants: ${this.project.people.toString()} people assigned.`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler),this.element.querySelector("button").addEventListener("click",this.deleteItem)}renderContent(){this.element.querySelector("h2").textContent=`Title: ${this.project.title}`,this.element.querySelector("h3").textContent=this.person,this.element.querySelector("button").textContent="Delete",this.element.querySelector("button").id=this.project.id,this.element.querySelector("p").textContent=`Description:  ${this.project.description}`}deleteItem(){i.deleteProject(this.project.id)}}c([e],h.prototype,"dragStartHandler",null),c([e],h.prototype,"deleteItem",null);var d=function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};class p extends l{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const r=e.dataTransfer.getData("text/plain");i.moveProject(r,"active"===this.type?t.ACTIVE:t.FINISHIED)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),i.addListener((e=>{const r=e.filter((e=>"active"===this.type?e.status===t.ACTIVE:e.status===t.FINISHIED));this.assignProjects=r,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=`${this.type} projects`.toUpperCase()}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignProjects)new h(this.element.querySelector("ul").id,e)}}d([e],p.prototype,"dragOverHandler",null),d([e],p.prototype,"dropHandler",null),d([e],p.prototype,"dragLeaveHandler",null),new a,new p("active"),new p("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ly4vc3JjL3RzL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3RzL21vZGVscy9wcm9qZWN0LnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy91dGlsL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3RzL2NvbXBvbmVudHMvYmFzZS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3RzL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvdHMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3RzL2NvbXBvbmVudHMvcHJvamVjdC1saXN0LnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy90cy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIEF1dG9iaW5kKF86IGFueSwgXzI6IHN0cmluZyB8IG51bWJlciwgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XHJcbiAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xyXG4gIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgZ2V0KCkge1xyXG4gICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgcmV0dXJuIGJvdW5kRm47XHJcbiAgICB9LFxyXG4gIH07XHJcbiAgcmV0dXJuIGFkakRlc2NyaXB0b3I7XHJcbn1cclxuIiwiZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XHJcbiAgQUNUSVZFLFxyXG4gIEZJTklTSElFRCxcclxufVxyXG5leHBvcnQgY2xhc3MgUHJvamVjdCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgaWQ6IHN0cmluZyxcclxuICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nLFxyXG4gICAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXHJcbiAgICBwdWJsaWMgc3RhdHVzOiBQcm9qZWN0U3RhdHVzXHJcbiAgKSB7fVxyXG59XHJcbiIsImltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuLy8gU3RhdGUgQ29tcG9uZW50ICBDbGFzc1xyXG5jbGFzcyBTdGF0ZUNvbXBvbmVudDxUPiB7XHJcbiAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xyXG4gIGFkZExpc3RlbmVyKGxpc3RlbmVyRm46IExpc3RlbmVyPFQ+KSB7XHJcbiAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyRm4pO1xyXG4gIH1cclxufVxyXG5cclxuLy8gUHJvamVjdCBTdGF0ZSBDbGFzc1xyXG50eXBlIExpc3RlbmVyPFQ+ID0gKHByb2plY3RzOiBUW10pID0+IHZvaWQ7XHJcblxyXG5jbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZUNvbXBvbmVudDxQcm9qZWN0PiB7XHJcbiAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgfVxyXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgIGlmICh0aGlzLmluc3RhbmNlKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKTtcclxuICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGFkZFByb2plY3QodGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgcGVvcGxlOiBudW1iZXIpIHtcclxuICAgIGNvbnN0IGlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygpO1xyXG4gICAgY29uc3QgcHJvamVjdCA9IG5ldyBQcm9qZWN0KFxyXG4gICAgICBpZCxcclxuICAgICAgdGl0bGUsXHJcbiAgICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgICBwZW9wbGUsXHJcbiAgICAgIFByb2plY3RTdGF0dXMuQUNUSVZFXHJcbiAgICApO1xyXG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKHByb2plY3QpO1xyXG4gICAgdGhpcy51cGRhdGVkTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBtb3ZlUHJvamVjdChwcmpJZDogc3RyaW5nLCBwcmpzdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcclxuICAgIGNvbnN0IHByaiA9IHRoaXMucHJvamVjdHMuZmluZCgocHJqKSA9PiBwcmouaWQgPT09IHByaklkKTtcclxuICAgIGlmIChwcmogJiYgcHJqLnN0YXR1cyAhPT0gcHJqc3RhdHVzKSB7XHJcbiAgICAgIHByai5zdGF0dXMgPSBwcmpzdGF0dXM7XHJcbiAgICAgIHRoaXMudXBkYXRlZExpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gIH1cclxuICBkZWxldGVQcm9qZWN0KHByaklkOiBzdHJpbmcpIHtcclxuICAgIHRoaXMucHJvamVjdHMgPSB0aGlzLnByb2plY3RzLmZpbHRlcigocHJvamVjdCkgPT4gcHJvamVjdC5pZCAhPT0gcHJqSWQpO1xyXG4gICAgdGhpcy51cGRhdGVkTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZWRMaXN0ZW5lcnMoKSB7XHJcbiAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4vLyBJbnN0YW50aWF0aW9uXHJcbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKTtcclxuIiwiZXhwb3J0IGludGVyZmFjZSB2YWxpZGF0ZVR5cGUge1xyXG4gIHZhbHVlOiBzdHJpbmcgfCBudW1iZXI7XHJcbiAgcmVxdWlyZWQ/OiB0cnVlIHwgZmFsc2U7XHJcbiAgbWluTGVuZ3RoPzogbnVtYmVyO1xyXG4gIG1heExlbmd0aD86IG51bWJlcjtcclxuICBtaW4/OiBudW1iZXI7XHJcbiAgbWF4PzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGFibGVJbnB1dDogdmFsaWRhdGVUeXBlKSB7XHJcbiAgaWYgKHZhbGlkYXRhYmxlSW5wdXQucmVxdWlyZWQpIHtcclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0LnZhbHVlLnRvU3RyaW5nKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiAnVmFsdWUgaXMgcmVxdWlyZWQuJztcclxuICAgIH1cclxuICB9XHJcbiAgaWYgKFxyXG4gICAgdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGggIT0gbnVsbCAmJlxyXG4gICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdzdHJpbmcnXHJcbiAgKSB7XHJcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPCB2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCkge1xyXG4gICAgICByZXR1cm4gYENoYXJhY3RlciBzaG91bGQgaGF2ZSBhIG1pbmltdW0gbGVuZ3RoIG9mICR7dmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGh9LmA7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmIChcclxuICAgIHZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoICE9IG51bGwgJiZcclxuICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJ1xyXG4gICkge1xyXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID4gdmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIGBDaGFyYWN0ZXIgc2hvdWxkIGhhdmUgYSBtYXhpbXVtIGxlbmd0aCBvZiAke3ZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RofS5gO1xyXG4gICAgfVxyXG4gIH1cclxuICBpZiAoXHJcbiAgICB2YWxpZGF0YWJsZUlucHV0Lm1pbiAhPSBudWxsICYmXHJcbiAgICB0eXBlb2YgK3ZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInXHJcbiAgKSB7XHJcbiAgICBpZiAoK3ZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPCB2YWxpZGF0YWJsZUlucHV0Lm1pbikge1xyXG4gICAgICByZXR1cm4gYFBhcnRpY2lwYW50cyBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICR7dmFsaWRhdGFibGVJbnB1dC5taW59LmA7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmIChcclxuICAgIHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiZcclxuICAgIHR5cGVvZiArdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcidcclxuICApIHtcclxuICAgIGlmICgrdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+IHZhbGlkYXRhYmxlSW5wdXQubWF4KSB7XHJcbiAgICAgIHJldHVybiBgUGFydGljaXBhbnRzIHNob3VsZCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJHt2YWxpZGF0YWJsZUlucHV0Lm1heH0uYDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiAnJztcclxufVxyXG4iLCJleHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XHJcbiAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gIGhvc3RFbGVtZW50OiBUO1xyXG4gIGVsZW1lbnQ6IFU7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHRlbXBsYXRlSWQ6IHN0cmluZyxcclxuICAgIHByaXZhdGUgaG9zdEVsZW1lbnRJZDogc3RyaW5nLFxyXG4gICAgcHJpdmF0ZSBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxyXG4gICAgcHJpdmF0ZSBuZXdFbGVtZW50SWQ/OiBzdHJpbmdcclxuICApIHtcclxuICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgICAgIHRoaXMudGVtcGxhdGVJZFxyXG4gICAgKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgIHRoaXMuaG9zdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmhvc3RFbGVtZW50SWQpISBhcyBUO1xyXG5cclxuICAgIGNvbnN0IGltcG9ydGVkTm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUoXHJcbiAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXHJcbiAgICAgIHRydWVcclxuICAgICk7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcclxuICAgIGlmICh0aGlzLm5ld0VsZW1lbnRJZCkgdGhpcy5lbGVtZW50LmlkID0gdGhpcy5uZXdFbGVtZW50SWQ7XHJcblxyXG4gICAgdGhpcy5hdHRhY2goKTtcclxuICB9XHJcbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XHJcbiAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG4gIHByaXZhdGUgYXR0YWNoKCkge1xyXG4gICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXHJcbiAgICAgIHRoaXMuaW5zZXJ0QXRTdGFydCA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLFxyXG4gICAgICB0aGlzLmVsZW1lbnRcclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnO1xyXG5pbXBvcnQgeyB2YWxpZGF0ZSwgdmFsaWRhdGVUeXBlIH0gZnJvbSAnLi4vdXRpbC92YWxpZGF0aW9uJztcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcclxuICB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcclxuICBkZXNjcmlwdGlvbklucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcclxuICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgdGl0bGVFcnJvckVsZW1lbnQ6IEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG4gIGRlc2NyaXB0aW9uRXJyb3JFbGVtZW50OiBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICBwZW9wbGVFcnJvckVsZW1lbnQ6IEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCdwcm9qZWN0LWlucHV0JywgJ2FwcCcsIHRydWUsICd1c2VyLWlucHV0Jyk7XHJcblxyXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnI3RpdGxlJ1xyXG4gICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnI2Rlc2NyaXB0aW9uJ1xyXG4gICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJyNwZW9wbGUnXHJcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLnRpdGxlRXJyb3JFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICcjdGl0bGVfZXJyb3InXHJcbiAgICApIGFzIEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbkVycm9yRWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAnI2Rlc2NyaXB0aW9uX2Vycm9yJ1xyXG4gICAgKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICAgIHRoaXMucGVvcGxlRXJyb3JFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICcjcGVvcGxlX2Vycm9yJ1xyXG4gICAgKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gIH1cclxuICBjb25maWd1cmUoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbiAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHt9XHJcbiAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXQoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XHJcbiAgICBjb25zdCBlbnRlcmVkVGlsdGxlID0gdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZS50cmltKCk7XHJcbiAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlLnRyaW0oKTtcclxuICAgIGNvbnN0IGVudGVyZWRQcm9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZS50cmltKCk7XHJcbiAgICBjb25zdCB0aXRsZVZhbGlkYXRlOiB2YWxpZGF0ZVR5cGUgPSB7XHJcbiAgICAgIHZhbHVlOiBlbnRlcmVkVGlsdGxlLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgbWluTGVuZ3RoOiA0LFxyXG4gICAgICBtYXhMZW5ndGg6IDEwLFxyXG4gICAgfTtcclxuICAgIGNvbnN0IGRlc2NyaXB0aW9uVmFsaWRhdGU6IHZhbGlkYXRlVHlwZSA9IHtcclxuICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbkxlbmd0aDogNCxcclxuICAgICAgbWF4TGVuZ3RoOiAxMCxcclxuICAgIH07XHJcbiAgICBjb25zdCBwZW9wbGVWYWxpZGF0ZTogdmFsaWRhdGVUeXBlID0ge1xyXG4gICAgICB2YWx1ZTogZW50ZXJlZFByb3BsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbjogMCxcclxuICAgICAgbWF4OiA1LFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIHZhbGlkYXRlKHRpdGxlVmFsaWRhdGUpIHx8XHJcbiAgICAgIHZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGUpIHx8XHJcbiAgICAgIHZhbGlkYXRlKHBlb3BsZVZhbGlkYXRlKVxyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuc2hvd0lucHV0c0Vycm9yKFxyXG4gICAgICAgIHZhbGlkYXRlKHRpdGxlVmFsaWRhdGUpLFxyXG4gICAgICAgIHZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGUpLFxyXG4gICAgICAgIHZhbGlkYXRlKHBlb3BsZVZhbGlkYXRlKVxyXG4gICAgICApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFtlbnRlcmVkVGlsdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUHJvcGxlXTtcclxuICAgIH1cclxuICB9XHJcbiAgcHJpdmF0ZSBzaG93SW5wdXRzRXJyb3IoXHJcbiAgICB0aXRsZUVycm9yOiBzdHJpbmcsXHJcbiAgICBkZXNjcmlwdGlvbkVycm9yOiBzdHJpbmcsXHJcbiAgICBwZW9wbGVFcnJvcjogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICB0aGlzLmNsZWFuRXJyb3JzKCk7XHJcbiAgICBpZiAodGl0bGVFcnJvcikge1xyXG4gICAgICB0aGlzLnRpdGxlRXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gdGl0bGVFcnJvcjtcclxuICAgIH1cclxuICAgIGlmIChkZXNjcmlwdGlvbkVycm9yKSB7XHJcbiAgICAgIHRoaXMuZGVzY3JpcHRpb25FcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbkVycm9yO1xyXG4gICAgfVxyXG4gICAgaWYgKHBlb3BsZUVycm9yKSB7XHJcbiAgICAgIHRoaXMucGVvcGxlRXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gcGVvcGxlRXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgY2xlYW5FcnJvcnMoKSB7XHJcbiAgICB0aGlzLnRpdGxlRXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uRXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICB0aGlzLnBlb3BsZUVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcclxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgfVxyXG4gIEBBdXRvYmluZFxyXG4gIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpO1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGVdID0gdXNlcklucHV0O1xyXG4gICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSk7XHJcbiAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcclxuICAgICAgdGhpcy5jbGVhbkVycm9ycygpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBBdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XHJcbmltcG9ydCB7IERyYWdnYWJsZSB9IGZyb20gXCIuLi9tb2RlbHMvZHJhZy1kcm9wXCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbVxyXG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+XHJcbiAgaW1wbGVtZW50cyBEcmFnZ2FibGVcclxue1xyXG4gIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcclxuICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xyXG4gICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZCk7XHJcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gIH1cclxuICBnZXQgcGVyc29uKCkge1xyXG4gICAgaWYgKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcclxuICAgICAgcmV0dXJuIGBQYXJ0aWNpcGFudHM6ICR7dGhpcy5wcm9qZWN0LnBlb3BsZS50b1N0cmluZygpfSBwZXJzb24gYXNzaWduZWQuYDtcclxuICAgIH1cclxuICAgIHJldHVybiBgUGFydGljaXBhbnRzOiAke3RoaXMucHJvamVjdC5wZW9wbGUudG9TdHJpbmcoKX0gcGVvcGxlIGFzc2lnbmVkLmA7XHJcbiAgfVxyXG4gIEBBdXRvYmluZFxyXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5wcm9qZWN0LmlkKTtcclxuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcclxuICB9XHJcblxyXG4gIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge31cclxuXHJcbiAgY29uZmlndXJlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCdidXR0b24nKSFcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5kZWxldGVJdGVtKTtcclxuICB9XHJcbiAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9YFRpdGxlOiAke3RoaXMucHJvamVjdC50aXRsZX1gO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb247XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uJykhLnRleHRDb250ZW50ID0gJ0RlbGV0ZSc7XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uJykhLmlkID0gdGhpcy5wcm9qZWN0LmlkO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICdwJ1xyXG4gICAgKSEudGV4dENvbnRlbnQgPSBgRGVzY3JpcHRpb246ICAke3RoaXMucHJvamVjdC5kZXNjcmlwdGlvbn1gO1xyXG4gIH1cclxuICBAQXV0b2JpbmRcclxuICBkZWxldGVJdGVtKCk6IHZvaWQge1xyXG4gICAgcHJvamVjdFN0YXRlLmRlbGV0ZVByb2plY3QodGhpcy5wcm9qZWN0LmlkKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xyXG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcclxuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0XHJcbiAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PlxyXG4gIGltcGxlbWVudHMgRHJhZ1RhcmdldFxyXG57XHJcbiAgYXNzaWduUHJvamVjdHM6IFByb2plY3RbXTtcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6ICdhY3RpdmUnIHwgJ2ZpbmlzaGVkJykge1xyXG4gICAgc3VwZXIoJ3Byb2plY3QtbGlzdCcsICdhcHAnLCBmYWxzZSwgYCR7dHlwZX0tcHJvamVjdHNgKTtcclxuICAgIHRoaXMuYXNzaWduUHJvamVjdHMgPSBbXTtcclxuXHJcbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgfVxyXG4gIEBBdXRvYmluZFxyXG4gIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nKSB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IHVsRWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICB1bEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIEBBdXRvYmluZFxyXG4gIGRyb3BIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QoXHJcbiAgICAgIHByaklkLFxyXG4gICAgICB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BQ1RJVkUgOiBQcm9qZWN0U3RhdHVzLkZJTklTSElFRFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIEBBdXRvYmluZFxyXG4gIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCB1bEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgIHVsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKTtcclxuICB9XHJcbiAgY29uZmlndXJlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5kcmFnT3ZlckhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLmRyb3BIYW5kbGVyKTtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xyXG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlbGV2YW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKHByajogUHJvamVjdCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdhY3RpdmUnKSB7XHJcbiAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BQ1RJVkU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZJTklTSElFRDtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmFzc2lnblByb2plY3RzID0gcmVsZXZhbnRQcm9qZWN0cztcclxuICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJlbmRlckNvbnRlbnQoKTogdm9pZCB7XHJcbiAgICBjb25zdCBsaXN0aWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdGlkO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID1cclxuICAgICAgYCR7dGhpcy50eXBlfSBwcm9qZWN0c2AudG9VcHBlckNhc2UoKTtcclxuICB9XHJcbiAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcclxuICAgIGNvbnN0IHVsRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gICAgICBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgXHJcbiAgICApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgdWxFbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgZm9yIChjb25zdCBwcm9qZWN0IG9mIHRoaXMuYXNzaWduUHJvamVjdHMpIHtcclxuICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgcHJvamVjdCk7XHJcbiAgICB9XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnO1xuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xuXG4vLyBJbnN0YW50aWF0aW9uXG5uZXcgUHJvamVjdElucHV0KCk7XG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xubmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpO1xuIl0sIm5hbWVzIjpbIkF1dG9iaW5kIiwiXyIsIl8yIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiYmluZCIsInRoaXMiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsImNvbnN0cnVjdG9yIiwiaWQiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiU3RhdGVDb21wb25lbnQiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwiUHJvamVjdFN0YXRlIiwic3VwZXIiLCJwcm9qZWN0cyIsInN0YXRpYyIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInByb2plY3QiLCJBQ1RJVkUiLCJ1cGRhdGVkTGlzdGVuZXJzIiwibW92ZVByb2plY3QiLCJwcmpJZCIsInByanN0YXR1cyIsInByaiIsImZpbmQiLCJkZWxldGVQcm9qZWN0IiwiZmlsdGVyIiwic2xpY2UiLCJwcm9qZWN0U3RhdGUiLCJnZXRJbnN0YW5jZSIsInZhbGlkYXRlIiwidmFsaWRhdGFibGVJbnB1dCIsInJlcXVpcmVkIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiQ29tcG9uZW50IiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhdHRhY2giLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJQcm9qZWN0SW5wdXQiLCJ0aXRsZUlucHV0RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsInBlb3BsZUlucHV0RWxlbWVudCIsInRpdGxlRXJyb3JFbGVtZW50IiwiZGVzY3JpcHRpb25FcnJvckVsZW1lbnQiLCJwZW9wbGVFcnJvckVsZW1lbnQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsInJlbmRlckNvbnRlbnQiLCJnYXRoZXJVc2VySW5wdXQiLCJlbnRlcmVkVGlsdGxlIiwidHJpbSIsImVudGVyZWREZXNjcmlwdGlvbiIsImVudGVyZWRQcm9wbGUiLCJ0aXRsZVZhbGlkYXRlIiwiZGVzY3JpcHRpb25WYWxpZGF0ZSIsInBlb3BsZVZhbGlkYXRlIiwic2hvd0lucHV0c0Vycm9yIiwidGl0bGVFcnJvciIsImRlc2NyaXB0aW9uRXJyb3IiLCJwZW9wbGVFcnJvciIsImNsZWFuRXJyb3JzIiwidGV4dENvbnRlbnQiLCJjbGVhcklucHV0cyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJQcm9qZWN0SXRlbSIsImhvc3RJZCIsInBlcnNvbiIsImRyYWdTdGFydEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwiZGVsZXRlSXRlbSIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnblByb2plY3RzIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJkcm9wSGFuZGxlciIsImdldERhdGEiLCJGSU5JU0hJRUQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwicmVsZXZhbnRQcm9qZWN0cyIsInJlbmRlclByb2plY3RzIiwibGlzdGlkIiwidG9VcHBlckNhc2UiLCJpbm5lckhUTUwiXSwic291cmNlUm9vdCI6IiJ9